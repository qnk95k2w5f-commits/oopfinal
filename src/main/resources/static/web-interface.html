<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>üé¨ Cinema Booking System</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:20px}
        .container{max-width:1400px;margin:0 auto}
        header{background:#fff;padding:30px;border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,.2);margin-bottom:30px;text-align:center}
        h1{color:#667eea;font-size:3em;margin-bottom:10px}
        .subtitle{color:#666;font-size:1.2em}
        .tabs-container{background:#fff;padding:20px;border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,.2);margin-bottom:20px}
        .main-tabs{display:grid;grid-template-columns:repeat(4,1fr);gap:15px;margin-bottom:20px}
        .main-tab{padding:20px;background:#f5f5f5;border:none;border-radius:10px;font-size:1.1em;font-weight:600;cursor:pointer;transition:all .3s}
        .main-tab:hover{transform:translateY(-3px);box-shadow:0 5px 15px rgba(0,0,0,.1)}
        .main-tab.active{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff}
        .tab-icon{font-size:2em;display:block;margin-bottom:10px}
        .tab-content{display:none}
        .tab-content.active{display:block}
        .section{display:grid;grid-template-columns:350px 1fr;gap:20px;margin-bottom:20px}
        .panel{background:#fff;padding:25px;border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,.2)}
        .panel h2{color:#667eea;margin-bottom:20px;padding-bottom:10px;border-bottom:2px solid #667eea}
        .form-group{margin-bottom:15px}
        label{display:block;margin-bottom:5px;color:#333;font-weight:500}
        input,select,textarea{width:100%;padding:12px;border:2px solid #e0e0e0;border-radius:8px;font-size:14px;transition:all .3s}
        input:focus,select:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px rgba(102,126,234,.1)}
        .btn{padding:12px 30px;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s;margin-right:10px;margin-top:10px}
        .btn-primary{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff}
        .btn-primary:hover{transform:translateY(-2px);box-shadow:0 5px 15px rgba(102,126,234,.4)}
        .btn-secondary{background:#f5f5f5;color:#333}
        .btn-danger{background:#e74c3c;color:#fff;padding:8px 15px;font-size:14px}
        .data-table{width:100%;border-collapse:collapse;margin-top:20px}
        .data-table th{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;padding:15px;text-align:left;font-weight:600}
        .data-table td{padding:15px;border-bottom:1px solid #e0e0e0}
        .data-table tr:hover{background:#f8f9ff}
        .badge{display:inline-block;padding:5px 12px;border-radius:20px;font-size:12px;font-weight:600}
        .badge-paid{background:#27ae60;color:#fff}
        .badge-unpaid{background:#e74c3c;color:#fff}
        .badge-premium{background:#f39c12;color:#fff}
        .rating-stars{color:#f39c12;font-size:1.2em}
        .empty-state{text-align:center;padding:60px;color:#999}
        .empty-state-icon{font-size:4em;margin-bottom:20px;opacity:.3}
        .notification{position:fixed;top:20px;right:20px;padding:15px 25px;background:#fff;border-radius:8px;box-shadow:0 5px 20px rgba(0,0,0,.3);display:none;z-index:1000;animation:slideIn .3s ease-out}
        .notification.show{display:block}
        @keyframes slideIn{from{transform:translateX(400px);opacity:0}to{transform:translateX(0);opacity:1}}
        .notification.success{border-left:4px solid #27ae60}
        .notification.error{border-left:4px solid #e74c3c}
        .search-box{margin-bottom:15px}
        @media (max-width:1024px){.section{grid-template-columns:1fr}.main-tabs{grid-template-columns:repeat(2,1fr)}}
        @media (max-width:768px){h1{font-size:2em}.main-tabs{grid-template-columns:1fr}}
    </style>
</head>
<body>
<div class="container">
    <header>
        <h1>üé¨ Cinema Booking System</h1>
        <p class="subtitle">–°–∏—Å—Ç–µ–º–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –±–∏–ª–µ—Ç–æ–≤ –≤ –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä</p>
    </header>

    <div class="tabs-container">
        <div class="main-tabs">
            <button class="main-tab active" data-tab="movies" onclick="switchTab(event,'movies')"><span class="tab-icon">üé•</span>–§–∏–ª—å–º—ã</button>
            <button class="main-tab" data-tab="cinemas" onclick="switchTab(event,'cinemas')"><span class="tab-icon">üè¢</span>–ö–∏–Ω–æ—Ç–µ–∞—Ç—Ä—ã</button>
            <button class="main-tab" data-tab="viewers" onclick="switchTab(event,'viewers')"><span class="tab-icon">üë•</span>–ó—Ä–∏—Ç–µ–ª–∏</button>
            <button class="main-tab" data-tab="bookings" onclick="switchTab(event,'bookings')"><span class="tab-icon">üé´</span>–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</button>
        </div>
    </div>

    <!-- MOVIES -->
    <div id="movies-content" class="tab-content active">
        <div class="section">
            <div class="panel">
                <h2>‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å–º</h2>
                <form id="movieForm">
                    <div class="form-group"><label>–ù–∞–∑–≤–∞–Ω–∏–µ *</label><input type="text" id="movieName" required></div>
                    <div class="form-group">
                        <label>–ñ–∞–Ω—Ä</label>
                        <select id="movieGenre">
                            <option>Action</option><option>Drama</option><option>Sci-Fi</option><option>Comedy</option>
                            <option>Horror</option><option>Romance</option><option>Crime</option>
                        </select>
                    </div>
                    <div class="form-group"><label>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–∏–Ω)</label><input type="number" id="movieDuration" min="1" value="120"></div>
                    <div class="form-group"><label>–†–µ–π—Ç–∏–Ω–≥ (0-10)</label><input type="number" id="movieRating" min="0" max="10" step="0.1" value="8.0"></div>
                    <div class="form-group"><label>–†–µ–∂–∏—Å—Å—ë—Ä</label><input type="text" id="movieDirector"></div>
                    <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å–º</button>
                    <button type="reset" class="btn btn-secondary">–û—á–∏—Å—Ç–∏—Ç—å</button>
                </form>
            </div>
            <div class="panel">
                <h2>üé• –°–ø–∏—Å–æ–∫ —Ñ–∏–ª—å–º–æ–≤</h2>
                <input type="text" id="movieSearch" class="search-box" placeholder="üîç –ü–æ–∏—Å–∫... (–ø–æ–∫–∞ –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞)">
                <div id="moviesContainer"></div>
            </div>
        </div>
    </div>

    <!-- CINEMAS -->
    <div id="cinemas-content" class="tab-content">
        <div class="section">
            <div class="panel">
                <h2>‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä</h2>
                <form id="cinemaForm">
                    <div class="form-group"><label>–ù–∞–∑–≤–∞–Ω–∏–µ *</label><input type="text" id="cinemaName" required></div>
                    <div class="form-group"><label>–ê–¥—Ä–µ—Å</label><input type="text" id="cinemaAddress"></div>
                    <div class="form-group"><label>–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å</label><input type="number" id="cinemaCapacity" min="1" value="200"></div>
                    <div class="form-group">
                        <label>–¢–∏–ø</label>
                        <select id="cinemaType"><option>IMAX</option><option>3D</option><option>Standard</option></select>
                    </div>
                    <div class="form-group"><label>–ù–æ–º–µ—Ä –∑–∞–ª–∞</label><input type="number" id="cinemaScreenNumber" min="1" value="1"></div>
                    <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä</button>
                    <button type="reset" class="btn btn-secondary">–û—á–∏—Å—Ç–∏—Ç—å</button>
                </form>
            </div>
            <div class="panel">
                <h2>üè¢ –°–ø–∏—Å–æ–∫ –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä–æ–≤</h2>
                <input type="text" id="cinemaSearch" class="search-box" placeholder="üîç –ü–æ–∏—Å–∫... (–ø–æ–∫–∞ –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞)">
                <div id="cinemasContainer"></div>
            </div>
        </div>
    </div>

    <!-- VIEWERS -->
    <div id="viewers-content" class="tab-content">
        <div class="section">
            <div class="panel">
                <h2>‚ûï –î–æ–±–∞–≤–∏—Ç—å –∑—Ä–∏—Ç–µ–ª—è</h2>
                <form id="viewerForm">
                    <div class="form-group"><label>–ò–º—è *</label><input type="text" id="viewerName" required></div>
                    <div class="form-group"><label>Email</label><input type="email" id="viewerEmail"></div>
                    <div class="form-group"><label>–¢–µ–ª–µ—Ñ–æ–Ω</label><input type="text" id="viewerPhone"></div>
                    <div class="form-group"><label>–í–æ–∑—Ä–∞—Å—Ç</label><input type="number" id="viewerAge" min="1" max="120"></div>
                    <div class="form-group">
                        <label>Premium</label>
                        <select id="viewerPremium"><option value="false">–û–±—ã—á–Ω—ã–π</option><option value="true">Premium</option></select>
                    </div>
                    <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å –∑—Ä–∏—Ç–µ–ª—è</button>
                    <button type="reset" class="btn btn-secondary">–û—á–∏—Å—Ç–∏—Ç—å</button>
                </form>
            </div>
            <div class="panel">
                <h2>üë• –°–ø–∏—Å–æ–∫ –∑—Ä–∏—Ç–µ–ª–µ–π</h2>
                <input type="text" id="viewerSearch" class="search-box" placeholder="üîç –ü–æ–∏—Å–∫... (–ø–æ–∫–∞ –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞)">
                <div id="viewersContainer"></div>
            </div>
        </div>
    </div>

    <!-- BOOKINGS -->
    <div id="bookings-content" class="tab-content">
        <div class="section">
            <div class="panel">
                <h2>‚ûï –°–æ–∑–¥–∞—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</h2>
                <form id="bookingForm">
                    <div class="form-group"><label>ID –ó—Ä–∏—Ç–µ–ª—è</label><input type="number" id="bookingViewerId" min="1" required></div>
                    <div class="form-group"><label>ID –§–∏–ª—å–º–∞</label><input type="number" id="bookingMovieId" min="1" required></div>
                    <div class="form-group"><label>ID –ö–∏–Ω–æ—Ç–µ–∞—Ç—Ä–∞</label><input type="number" id="bookingCinemaId" min="1" required></div>
                    <div class="form-group"><label>–î–∞—Ç–∞</label><input type="date" id="bookingDate" required></div>
                    <div class="form-group"><label>–í—Ä–µ–º—è</label><input type="time" id="bookingTime" required></div>
                    <div class="form-group"><label>–ú–µ—Å—Ç–æ</label><input type="number" id="bookingSeatNumber" min="1" required></div>
                    <div class="form-group"><label>–¶–µ–Ω–∞</label><input type="number" id="bookingPrice" min="0" step="0.01" required></div>
                    <div class="form-group">
                        <label>–°—Ç–∞—Ç—É—Å –æ–ø–ª–∞—Ç—ã</label>
                        <select id="bookingPaid"><option value="false">–ù–µ –æ–ø–ª–∞—á–µ–Ω–æ</option><option value="true">–û–ø–ª–∞—á–µ–Ω–æ</option></select>
                    </div>
                    <button type="submit" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</button>
                    <button type="reset" class="btn btn-secondary">–û—á–∏—Å—Ç–∏—Ç—å</button>
                </form>
            </div>
            <div class="panel">
                <h2>üé´ –°–ø–∏—Å–æ–∫ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π</h2>
                <input type="text" id="bookingSearch" class="search-box" placeholder="üîç –ü–æ–∏—Å–∫... (–ø–æ–∫–∞ –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞)">
                <div id="bookingsContainer"></div>
            </div>
        </div>
    </div>
</div>

<div id="notification" class="notification"></div>

<script>
    const API = "http://localhost:8080/api";

    let movies = [];
    let cinemas = [];
    let viewers = [];
    let bookings = [];

    function showNotification(message, type = 'success') {
      const n = document.getElementById('notification');
      n.textContent = message;
      n.className = `notification ${type} show`;
      setTimeout(() => n.classList.remove('show'), 3000);
    }

    async function apiJson(url, options = {}) {
      const r = await fetch(url, options);
      if (!r.ok) {
        const text = await r.text().catch(() => "");
        throw new Error(`HTTP ${r.status}: ${text || r.statusText}`);
      }
      // DELETE –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –ø—É—Å—Ç–æ
      const ct = r.headers.get("content-type") || "";
      if (ct.includes("application/json")) return r.json();
      return null;
    }

    async function apiGet(path) {
      return apiJson(`${API}${path}`);
    }

    async function apiPost(path, body) {
      return apiJson(`${API}${path}`, {
        method: "POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify(body)
      });
    }

    async function apiDelete(path) {
      return apiJson(`${API}${path}`, { method: "DELETE" });
    }

    function switchTab(ev, tab) {
      document.querySelectorAll('.main-tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));

      ev.target.closest('.main-tab').classList.add('active');
      document.getElementById(`${tab}-content`).classList.add('active');

      refresh(tab).catch(err => {
        console.error(err);
        showNotification("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: " + err.message, "error");
      });
    }

    async function refresh(tab) {
      if (tab === 'movies') movies = await apiGet("/movies") || [];
      if (tab === 'cinemas') cinemas = await apiGet("/cinemas") || [];
      if (tab === 'viewers') viewers = await apiGet("/viewers") || [];
      if (tab === 'bookings') bookings = await apiGet("/bookings") || [];
      renderData(tab);
    }

    // ====== FORMS ======
    document.getElementById('movieForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const dto = {
        // id –æ–±—ã—á–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ç –ë–î; –µ—Å–ª–∏ —É —Ç–µ–±—è id –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω ‚Äî –¥–æ–±–∞–≤—å –ø–æ–ª–µ –Ω–∞ —Ñ–æ—Ä–º–µ
        name: document.getElementById('movieName').value,
        genre: document.getElementById('movieGenre').value,
        duration: Number(document.getElementById('movieDuration').value),
        rating: Number(document.getElementById('movieRating').value),
        director: document.getElementById('movieDirector').value
      };
      try {
        await apiPost("/movies", dto);
        await refresh("movies");
        e.target.reset();
        showNotification("–§–∏–ª—å–º –¥–æ–±–∞–≤–ª–µ–Ω!");
      } catch (err) {
        console.error(err);
        showNotification("–û—à–∏–±–∫–∞: " + err.message, "error");
      }
    });

    document.getElementById('cinemaForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const dto = {
        name: document.getElementById('cinemaName').value,
        address: document.getElementById('cinemaAddress').value,
        capacity: Number(document.getElementById('cinemaCapacity').value),
        type: document.getElementById('cinemaType').value,
        screenNumber: Number(document.getElementById('cinemaScreenNumber').value)
      };
      try {
        await apiPost("/cinemas", dto);
        await refresh("cinemas");
        e.target.reset();
        showNotification("–ö–∏–Ω–æ—Ç–µ–∞—Ç—Ä –¥–æ–±–∞–≤–ª–µ–Ω!");
      } catch (err) {
        console.error(err);
        showNotification("–û—à–∏–±–∫–∞: " + err.message, "error");
      }
    });

    document.getElementById('viewerForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const dto = {
        name: document.getElementById('viewerName').value,
        email: document.getElementById('viewerEmail').value,
        phone: document.getElementById('viewerPhone').value,
        age: Number(document.getElementById('viewerAge').value),
        premium: document.getElementById('viewerPremium').value === "true" // ViewerDTO -> isPremium()
      };
      try {
        await apiPost("/viewers", dto);
        await refresh("viewers");
        e.target.reset();
        showNotification("–ó—Ä–∏—Ç–µ–ª—å –¥–æ–±–∞–≤–ª–µ–Ω!");
      } catch (err) {
        console.error(err);
        showNotification("–û—à–∏–±–∫–∞: " + err.message, "error");
      }
    });

    document.getElementById('bookingForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const dto = {
        viewerId: Number(document.getElementById('bookingViewerId').value),
        movieId: Number(document.getElementById('bookingMovieId').value),
        cinemaId: Number(document.getElementById('bookingCinemaId').value),
        bookingDate: document.getElementById('bookingDate').value,   // BookingDTO.getBookingDate()
        showTime: document.getElementById('bookingTime').value,      // BookingDTO.getShowTime()
        seatNumber: Number(document.getElementById('bookingSeatNumber').value),
        price: Number(document.getElementById('bookingPrice').value),
        paid: document.getElementById('bookingPaid').value === "true" // BookingDTO.setPaid(boolean)
      };
      try {
        await apiPost("/bookings", dto);
        await refresh("bookings");
        e.target.reset();
        showNotification("–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ!");
      } catch (err) {
        console.error(err);
        showNotification("–û—à–∏–±–∫–∞: " + err.message, "error");
      }
    });

    // ====== RENDER + DELETE ======
    function renderData(type) {
      const containers = {
        movies: 'moviesContainer',
        cinemas: 'cinemasContainer',
        viewers: 'viewersContainer',
        bookings: 'bookingsContainer'
      };

      const container = document.getElementById(containers[type]);
      const data = { movies, cinemas, viewers, bookings }[type];

      if (!data || data.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <div class="empty-state-icon">${type === 'movies' ? 'üé•' : type === 'cinemas' ? 'üè¢' : type === 'viewers' ? 'üë•' : 'üé´'}</div>
            <h3>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</h3>
          </div>`;
        return;
      }

      let html = '<table class="data-table"><thead><tr>';

      if (type === 'movies') {
        html += '<th>ID</th><th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>–ñ–∞–Ω—Ä</th><th>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</th><th>–†–µ–π—Ç–∏–Ω–≥</th><th>–†–µ–∂–∏—Å—Å—ë—Ä</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr></thead><tbody>';
        data.forEach(m => {
          const stars = '‚≠ê'.repeat(Math.round((m.rating || 0) / 2));
          html += `<tr>
            <td>${m.id}</td>
            <td><strong>${m.name}</strong></td>
            <td>${m.genre ?? ''}</td>
            <td>${m.duration ?? ''} –º–∏–Ω</td>
            <td><span class="rating-stars">${stars}</span> ${m.rating ?? ''}</td>
            <td>${m.director ?? ''}</td>
            <td><button class="btn btn-danger" onclick="deleteItem('movies', ${m.id})">–£–¥–∞–ª–∏—Ç—å</button></td>
          </tr>`;
        });
      } else if (type === 'cinemas') {
        html += '<th>ID</th><th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>–ê–¥—Ä–µ—Å</th><th>–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å</th><th>–¢–∏–ø</th><th>–ó–∞–ª</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr></thead><tbody>';
        data.forEach(c => {
          html += `<tr>
            <td>${c.id}</td>
            <td><strong>${c.name}</strong></td>
            <td>${c.address ?? ''}</td>
            <td>${c.capacity ?? ''}</td>
            <td><span class="badge badge-premium">${c.type ?? ''}</span></td>
            <td>${c.screenNumber ?? ''}</td>
            <td><button class="btn btn-danger" onclick="deleteItem('cinemas', ${c.id})">–£–¥–∞–ª–∏—Ç—å</button></td>
          </tr>`;
        });
      } else if (type === 'viewers') {
        html += '<th>ID</th><th>–ò–º—è</th><th>Email</th><th>–¢–µ–ª–µ—Ñ–æ–Ω</th><th>–í–æ–∑—Ä–∞—Å—Ç</th><th>–°—Ç–∞—Ç—É—Å</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr></thead><tbody>';
        data.forEach(v => {
          const premium = !!v.premium || !!v.isPremium; // –Ω–∞ —Å–ª—É—á–∞–π, –∫–∞–∫ —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç—Å—è
          html += `<tr>
            <td>${v.id}</td>
            <td><strong>${v.name}</strong></td>
            <td>${v.email ?? ''}</td>
            <td>${v.phone ?? ''}</td>
            <td>${v.age ?? ''}</td>
            <td><span class="badge ${premium ? 'badge-premium' : ''}">${premium ? 'Premium' : '–û–±—ã—á–Ω—ã–π'}</span></td>
            <td><button class="btn btn-danger" onclick="deleteItem('viewers', ${v.id})">–£–¥–∞–ª–∏—Ç—å</button></td>
          </tr>`;
        });
      } else {
        html += '<th>ID</th><th>–ó—Ä–∏—Ç–µ–ª—å ID</th><th>–§–∏–ª—å–º ID</th><th>–ö–∏–Ω–æ—Ç–µ–∞—Ç—Ä ID</th><th>–î–∞—Ç–∞</th><th>–í—Ä–µ–º—è</th><th>–ú–µ—Å—Ç–æ</th><th>–¶–µ–Ω–∞</th><th>–û–ø–ª–∞—Ç–∞</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr></thead><tbody>';
        data.forEach(b => {
          const paid = !!b.paid || !!b.isPaid;
          html += `<tr>
            <td>${b.id}</td>
            <td>${b.viewerId}</td>
            <td>${b.movieId}</td>
            <td>${b.cinemaId}</td>
            <td>${b.bookingDate ?? ''}</td>
            <td>${b.showTime ?? ''}</td>
            <td>${b.seatNumber ?? ''}</td>
            <td>${b.price ?? ''}</td>
            <td><span class="badge ${paid ? 'badge-paid' : 'badge-unpaid'}">${paid ? '–û–ø–ª–∞—á–µ–Ω–æ' : '–ù–µ –æ–ø–ª–∞—á–µ–Ω–æ'}</span></td>
            <td><button class="btn btn-danger" onclick="deleteItem('bookings', ${b.id})">–£–¥–∞–ª–∏—Ç—å</button></td>
          </tr>`;
        });
      }

      html += '</tbody></table>';
      container.innerHTML = html;
    }

    async function deleteItem(type, id) {
      if (!confirm('–£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å?')) return;

      const map = {
        movies: "/movies/",
        cinemas: "/cinemas/",
        viewers: "/viewers/",
        bookings: "/bookings/"
      };

      try {
        await apiDelete(map[type] + id);
        await refresh(type);
        showNotification("–£–¥–∞–ª–µ–Ω–æ", "error");
      } catch (err) {
        console.error(err);
        showNotification("–û—à–∏–±–∫–∞: " + err.message, "error");
      }
    }

    // initial load
    refresh("movies").catch(err => showNotification("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: " + err.message, "error"));
</script>
</body>
</html>
